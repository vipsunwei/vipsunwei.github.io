import{_ as s,c as n,o as a,N as l}from"./chunks/framework.1f285265.js";const p="/assets/husky-directory.a3c5f300.png",F=JSON.parse('{"title":"Husky å’Œ Lint-staged å…¥é—¨æŒ‡å—ï¼šGit æäº¤æ—¶è‡ªåŠ¨è¿›è¡Œä»£ç æ ¡éªŒå’Œæ ¼å¼åŒ–","description":"","frontmatter":{"title":"Husky å’Œ Lint-staged å…¥é—¨æŒ‡å—ï¼šGit æäº¤æ—¶è‡ªåŠ¨è¿›è¡Œä»£ç æ ¡éªŒå’Œæ ¼å¼åŒ–","date":"2023-04-03T18:30:00.000Z","aside":true,"tags":["Vite","Vue3","husky","lint-staged"]},"headers":[],"relativePath":"posts/2023/husky+lint-staged.md","lastUpdated":1680695128000}'),e={name:"posts/2023/husky+lint-staged.md"},o=l(`<p>å¤§å®¶å¥½, åœ¨ä¸Šä¸€ç¯‡<a href="./vite+vue3+eslint+prettier.html">Vue3+Vite é¡¹ç›®ï¼Œå¦‚ä½•é…ç½® ESLint å’Œ Prettier å®ç°ä»£ç è§„èŒƒåŒ–ï¼Ÿ</a>ä¸­æå†™äº†å¦‚ä½•ç»™æˆ‘ä»¬çš„<code>Vite</code>+<code>Vue3</code>é¡¹ç›®é…ç½®<code>ESLint</code>å’Œ<code>Prettier</code>, æ­¤ç¯‡æˆ‘ä»¬å°†è®°å½•<code>husky</code>å’Œ<code>lint-staged</code>å®ç°<code>git</code>æäº¤ä»£ç æ—¶å¯¹é¡¹ç›®ä»£ç è¿›è¡Œæ£€æŸ¥ä¸æ ¼å¼åŒ–.</p><h2 id="å®‰è£…-husky-å’Œ-lint-staged" tabindex="-1">å®‰è£… <code>husky</code> å’Œ <code>lint-staged</code> <a class="header-anchor" href="#å®‰è£…-husky-å’Œ-lint-staged" aria-label="Permalink to &quot;å®‰è£… \`husky\` å’Œ \`lint-staged\`&quot;">â€‹</a></h2><p>ç”¨ä¾‹ï¼šå½“æ‚¨æƒ³ä½¿ç”¨å…¶ä»–ä»£ç è´¨é‡å·¥å…·å’Œ <code>Prettier</code>ï¼ˆä¾‹å¦‚ <code>ESLint</code>ã€<code>Styleint</code> ç­‰ï¼‰æ—¶ï¼Œæˆ–è€…å¦‚æœæ‚¨éœ€è¦å¯¹éƒ¨åˆ†æš‚å­˜æ–‡ä»¶è¿›è¡Œæ£€æŸ¥æ—¶ï¼ˆ<code>git add --patch</code>ï¼‰ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</p><p>åœ¨ç»§ç»­æ“ä½œä¹‹å‰ï¼Œè¯·ç¡®ä¿ <code>Prettier</code> å·²å®‰è£…å¹¶ä½äº <code>devDependencies</code> ä¸­ã€‚</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dlx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mrm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lint-staged</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># or</span></span>
<span class="line"><span style="color:#FFCB6B;">npx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mrm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lint-staged</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>è¿™å°†å®‰è£…<code>husky</code>å’Œ<code>lint-staged</code>ï¼Œç„¶åå‘é¡¹ç›®çš„<code>package.json</code>æ·»åŠ ä¸€ä¸ªé…ç½®ï¼Œè¯¥é…ç½®å°†åœ¨<code>pre-commit hook</code> ä¸­è‡ªåŠ¨æ£€æŸ¥å¹¶æ ¼å¼åŒ–æ”¯æŒçš„æ–‡ä»¶ã€‚</p><p>åœ¨<a href="https://github.com/okonet/lint-staged#configuration" target="_blank" rel="noreferrer">lint-staged</a><code>repo</code> ä¸­é˜…è¯»æ›´å¤šä¿¡æ¯ã€‚</p><p><strong>ä¸‹é¢æ˜¯æˆ‘çš„æ“ä½œè¿‡ç¨‹</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dlx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mrm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lint-staged</span></span>
<span class="line"><span style="color:#82AAFF;">...</span><span style="color:#FFCB6B;">/Library/pnpm/store/v3/tmp/dlx-82832</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">+266</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+++++++++++++++++++++++++++</span></span>
<span class="line"><span style="color:#82AAFF;">...</span><span style="color:#FFCB6B;">/Library/pnpm/store/v3/tmp/dlx-82832</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Progress:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">resolved</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">266</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reused</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">227</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">downloaded</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">39</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">added</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">266</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">done</span></span>
<span class="line"><span style="color:#FFCB6B;">Running</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lint-staged...</span></span>
<span class="line"><span style="color:#FFCB6B;">Update</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">package.json</span></span>
<span class="line"><span style="color:#FFCB6B;">Installing</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lint-staged</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">and</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">husky...</span></span>
<span class="line"><span style="color:#FFCB6B;">Packages:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+</span><span style="color:#F78C6C;">45</span></span>
<span class="line"><span style="color:#FFCB6B;">+++++++++++++++++++++++++++++++++++++++++++++</span></span>
<span class="line"><span style="color:#FFCB6B;">Progress:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">resolved</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">948</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reused</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">907</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">downloaded</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">added</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">45</span><span style="color:#C3E88D;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">devDependencies:</span></span>
<span class="line"><span style="color:#FFCB6B;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">husky</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">8.0.3</span></span>
<span class="line"><span style="color:#FFCB6B;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lint-staged</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">13.2.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Done</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">12.6s</span></span>
<span class="line"><span style="color:#FFCB6B;">husky</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hooks</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">installed</span></span>
<span class="line"><span style="color:#FFCB6B;">husky</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">created</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.husky/pre-commit</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>package.json</code>ä¸­éƒ½å‘ç”Ÿäº†ä»€ä¹ˆ</strong></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// package.json</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">prepare</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">husky install</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">devDependencies</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">husky</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&gt;=7</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">lint-staged</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&gt;=10</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">lint-staged</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">// å¸¦ç€ --cache æ‰§è¡Œä»£ç æ£€æŸ¥åä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª .eslintcache æ–‡ä»¶</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">*.{vue,js,jsx,ts,tsx}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">eslint --cache --fix</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ <code>--cache</code> æ˜¯å¹²ä»€ä¹ˆçš„?</strong></p><p>å­˜å‚¨æœ‰å…³å·²å¤„ç†æ–‡ä»¶çš„ä¿¡æ¯ï¼Œä»¥ä¾¿ä»…å¯¹å·²æ›´æ”¹çš„æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚å¯ç”¨æ­¤é€‰é¡¹å¯ä»¥ç¡®ä¿åªå¯¹æ›´æ”¹åçš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œä»è€Œæ˜¾è‘—æé«˜ <code>ESLint</code> çš„è¿è¡Œæ—¶æ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼“å­˜å­˜å‚¨åœ¨<code>.eslintcache</code> ä¸­ã€‚</p><p>è¿™ä¸ªæ–‡ä»¶é‡Œè¾¹ç¼“å­˜äº†è¢«æ£€æŸ¥æ–‡ä»¶çš„æœ¬åœ°ç»å¯¹è·¯å¾„, é‚£ä¹ˆæˆ‘ä»¬æ¯ä¸ªå¼€å‘äººå‘˜æ‰§è¡Œ<code>lint-staged</code>æˆ–<code>git</code>æäº¤åç”Ÿæˆçš„<code>.eslintcache</code>é‡Œè¾¹çš„è·¯å¾„åº”è¯¥éƒ½æ˜¯ä¸ä¸€æ ·çš„, æˆ‘çŒœå¯èƒ½ä¼šå‡ºç°å†²çª, æ‰€ä»¥å»ºè®®æŠŠè¿™ä¸ªæ–‡ä»¶åŠ åˆ°<code>.gitignore</code>ä¸­å¿½ç•¥æ‰, æˆ–è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä¸ä½¿ç”¨<code>--cache</code>, å½“ä¸ä½¿ç”¨<code>--cache</code>è¿›è¡Œæ£€æŸ¥æ—¶, <code>.eslintcache</code>æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨åˆ æ‰, å¦‚éœ€äº†è§£æ›´å¤šå¯ä»¥æŸ¥çœ‹ä¸‹é¢çš„å‚è€ƒèµ„æ–™</p><p><a href="https://eslint.org/docs/latest/use/command-line-interface#--cache" target="_blank" rel="noreferrer"><code>--cache</code> å‚è€ƒèµ„æ–™</a></p><p>åŒæ—¶, åœ¨æˆ‘ä»¬çš„é¡¹ç›®æ ¹ç›®å½•å¢åŠ äº†ä¸€ä¸ª<code>.husky</code>æ–‡ä»¶å¤¹, é‡Œè¾¹æ˜¯è¿™æ ·çš„</p><p><img src="`+p+'" alt=".husky"></p><blockquote><p>æ³¨æ„: è¿™ä¸ªæ‰§è¡Œå‘½ä»¤è‡ªåŠ¨ç”Ÿæˆçš„, æ‰‹åŠ¨åˆ›å»ºçš„å¥½åƒä¸å¥½ä½¿, ä¸è¿‡å¯ä»¥è‡ªå·±ä¿®æ”¹ç”Ÿæˆåçš„æ–‡ä»¶é‡Œè¾¹çš„å‘½ä»¤, æ¯”å¦‚æˆ‘ä»¬ç”¨çš„<code>pnpm</code>åŒ…ç®¡ç†å™¨, å°±å¯ä»¥ä¿®æ”¹<code>npx lint-staged</code>ä¸º<code>pnpm dlx lint-staged</code></p></blockquote><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><p>ä¸€è¡Œå‘½ä»¤æå®š(æ¨è)ğŸ‘ğŸ»</p><p>ä¸‹ä¸€ç¯‡<a href="./commitlint+cz.html">ä½¿ç”¨ commitlintã€cz å’Œ husky æ ¡éªŒ Git æäº¤ä¿¡æ¯ release-it è‡ªåŠ¨å‘å¸ƒå¹¶ç”Ÿæˆ CHANGELOG</a>, å°†å¸¦æ¥<code>commitlint</code>æ£€æŸ¥<code>git</code>æäº¤<code>message</code>, ä½¿ç”¨<code>cz-conventional-changelog</code>å¸®åŠ©å¼ºåˆ¶å¼€å‘è€…è§„èŒƒ<code>git</code>æäº¤<code>message</code>, <code>release-it</code>è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·å¹¶ä¸”è‡ªåŠ¨ç”Ÿæˆ<code>CHANGELOG.md</code></p>',21),c=[o];function t(r,C,y,i,d,D){return a(),n("div",null,c)}const u=s(e,[["render",t]]);export{F as __pageData,u as default};
