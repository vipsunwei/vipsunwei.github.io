import{_ as d}from"./chunks/ArticleMetadata.355516f3.js";import{_ as C,c as y,b as t,f as l,g as e,w as A,a as B,i as p,o,e as D,j as h}from"./app.4af0e587.js";const M=JSON.parse('{"title":"个人常用 SQL 函数","description":"","frontmatter":{"title":"个人常用 SQL 函数","author":"查尔斯","date":"2022/02/16 15:43","isTop":true,"categories":["杂碎逆袭史"],"tags":["SQL","SQL函数"]},"headers":[{"level":2,"title":"时间函数","slug":"时间函数","link":"#时间函数","children":[{"level":3,"title":"获取当前时间（MySQL）","slug":"获取当前时间-mysql","link":"#获取当前时间-mysql","children":[]},{"level":3,"title":"获取当前时间秒（MySQL）","slug":"获取当前时间秒-mysql","link":"#获取当前时间秒-mysql","children":[]},{"level":3,"title":"计算两个时间之间的间隔（MySQL）","slug":"计算两个时间之间的间隔-mysql","link":"#计算两个时间之间的间隔-mysql","children":[]}]},{"level":2,"title":"字符串函数","slug":"字符串函数","link":"#字符串函数","children":[{"level":3,"title":"拼接字符串（MySQL）","slug":"拼接字符串-mysql","link":"#拼接字符串-mysql","children":[]}]}],"relativePath":"categories/fragments/2022/02/16/个人常用SQL函数.md","lastUpdated":1677831742000}'),F={name:"categories/fragments/2022/02/16/个人常用SQL函数.md"},E={id:"个人常用-sql-函数",tabindex:"-1"},m=t("a",{class:"header-anchor",href:"#个人常用-sql-函数","aria-hidden":"true"},"#",-1),T=B(`<h2 id="时间函数" tabindex="-1">时间函数 <a class="header-anchor" href="#时间函数" aria-hidden="true">#</a></h2><h3 id="获取当前时间-mysql" tabindex="-1">获取当前时间（MySQL） <a class="header-anchor" href="#获取当前时间-mysql" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;"># 输出格式为：yyyy</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">MM</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dd HH:mm:ss</span></span>
<span class="line"><span style="color:#F78C6C;">NOW</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;"># 输出格式为：yyyy-MM-dd HH:mm:ss</span></span>
<span class="line"><span style="color:#C678DD;">NOW</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span></code></pre></div><h3 id="获取当前时间秒-mysql" tabindex="-1">获取当前时间秒（MySQL） <a class="header-anchor" href="#获取当前时间秒-mysql" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;"># 从 1970年1月1日 开始到现在的秒数</span></span>
<span class="line"><span style="color:#A6ACCD;">UNIX_TIMESTAMP</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;"># 从 1970年1月1日 开始到现在的秒数</span></span>
<span class="line"><span style="color:#ABB2BF;">UNIX_TIMESTAMP();</span></span>
<span class="line"></span></code></pre></div><h3 id="计算两个时间之间的间隔-mysql" tabindex="-1">计算两个时间之间的间隔（MySQL） <a class="header-anchor" href="#计算两个时间之间的间隔-mysql" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;"># unit 可选为FRAC_SECOND 毫秒、</span><span style="color:#F78C6C;">SECOND</span><span style="color:#A6ACCD;"> 秒、</span><span style="color:#F78C6C;">MINUTE</span><span style="color:#A6ACCD;"> 分钟、</span><span style="color:#F78C6C;">HOUR</span><span style="color:#A6ACCD;"> 小时、</span><span style="color:#F78C6C;">DAY</span><span style="color:#A6ACCD;"> 天、</span><span style="color:#F78C6C;">WEEK</span><span style="color:#A6ACCD;"> 星期、</span><span style="color:#F78C6C;">MONTH</span><span style="color:#A6ACCD;"> 月、</span><span style="color:#F78C6C;">QUARTER</span><span style="color:#A6ACCD;"> 季度、</span><span style="color:#F78C6C;">YEAR</span><span style="color:#A6ACCD;"> 年</span></span>
<span class="line"><span style="color:#A6ACCD;">TIMESTAMPDIFF(unit, datetime_expr1, datetime_expr2)</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;"># unit 可选为FRAC_SECOND 毫秒、</span><span style="color:#C678DD;">SECOND</span><span style="color:#ABB2BF;"> 秒、</span><span style="color:#C678DD;">MINUTE</span><span style="color:#ABB2BF;"> 分钟、</span><span style="color:#C678DD;">HOUR</span><span style="color:#ABB2BF;"> 小时、</span><span style="color:#C678DD;">DAY</span><span style="color:#ABB2BF;"> 天、</span><span style="color:#C678DD;">WEEK</span><span style="color:#ABB2BF;"> 星期、</span><span style="color:#C678DD;">MONTH</span><span style="color:#ABB2BF;"> 月、</span><span style="color:#C678DD;">QUARTER</span><span style="color:#ABB2BF;"> 季度、</span><span style="color:#C678DD;">YEAR</span><span style="color:#ABB2BF;"> 年</span></span>
<span class="line"><span style="color:#ABB2BF;">TIMESTAMPDIFF(unit, datetime_expr1, datetime_expr2)</span></span>
<span class="line"></span></code></pre></div><h2 id="字符串函数" tabindex="-1">字符串函数 <a class="header-anchor" href="#字符串函数" aria-hidden="true">#</a></h2><h3 id="拼接字符串-mysql" tabindex="-1">拼接字符串（MySQL） <a class="header-anchor" href="#拼接字符串-mysql" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;"># 将多个字符串拼接在一起</span></span>
<span class="line"><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(str1, str2, ...)</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;"># 将多个字符串拼接在一起</span></span>
<span class="line"><span style="color:#56B6C2;">CONCAT</span><span style="color:#ABB2BF;">(str1, str2, ...)</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">笔者说</p><p>这个函数看起来平平无奇，但实际用起来，可不只是真香。你可能会在 MyBatis 中解决 SQL 注入的时候用到它，还可能在一些 “奇怪” 的场景用到它。</p></div><h4 id="清空数据库中的所有表数据" tabindex="-1">清空数据库中的所有表数据 <a class="header-anchor" href="#清空数据库中的所有表数据" aria-hidden="true">#</a></h4><p>清空单表数据很简单。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">TRUNCATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> 表名;</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#C678DD;">TRUNCATE</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">TABLE</span><span style="color:#ABB2BF;"> 表名;</span></span>
<span class="line"></span></code></pre></div><p>但是，如果现在有 100 + 张表？你当然不会一个一个的去 <code>TRUNCATE</code>，但 MySQL 又没有提供该功能。那你可以用用下面的方法。</p><ol><li><p>查询该数据库下的所有表，利用 <code>CONCAT()</code> 函数将 <code>TRUNCATE</code> 语句拼接起来</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">CONCAT(&#39;TRUNCATE</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, TABLE_NAME, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">)</span></span>
<span class="line"><span style="color:#C3E88D;">FROM </span></span>
<span class="line"><span style="color:#C3E88D;">  information_schema.TABLES</span></span>
<span class="line"><span style="color:#C3E88D;">WHERE TABLE_SCHEMA = </span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">数据库名</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;">  CONCAT(&#39;TRUNCATE </span><span style="color:#98C379;">TABLE</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;, TABLE_NAME, &#39;</span><span style="color:#ABB2BF;">;</span><span style="color:#98C379;">&#39;)</span></span>
<span class="line"><span style="color:#98C379;">FROM </span></span>
<span class="line"><span style="color:#98C379;">  information_schema.TABLES</span></span>
<span class="line"><span style="color:#98C379;">WHERE TABLE_SCHEMA = &#39;</span><span style="color:#ABB2BF;">数据库名</span><span style="color:#98C379;">&#39;;</span></span>
<span class="line"></span></code></pre></div></li><li><p>将执行结果复制，直接执行即可</p></li></ol><h4 id="删除数据库中的所有表" tabindex="-1">删除数据库中的所有表 <a class="header-anchor" href="#删除数据库中的所有表" aria-hidden="true">#</a></h4><p>删除单表很简单。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> 表名;</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#C678DD;">DROP</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">TABLE</span><span style="color:#ABB2BF;"> 表名;</span></span>
<span class="line"></span></code></pre></div><p>但是，如果现在有 100 + 张表？你当然不会一个一个的去 <code>DROP</code>，但 MySQL 又没有提供该功能。那你可以用用下面的方法。</p><ol><li><p>查询该数据库下的所有表，利用 <code>CONCAT()</code> 函数将 <code>DROP</code> 语句拼接起来</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">CONCAT(&#39;DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">IF</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">EXISTS</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, TABLE_NAME, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">)</span></span>
<span class="line"><span style="color:#C3E88D;">FROM </span></span>
<span class="line"><span style="color:#C3E88D;">  information_schema.TABLES</span></span>
<span class="line"><span style="color:#C3E88D;">WHERE TABLE_SCHEMA = </span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">数据库名</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;">  CONCAT(&#39;DROP </span><span style="color:#98C379;">TABLE</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">IF</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">EXISTS</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;, TABLE_NAME, &#39;</span><span style="color:#ABB2BF;">;</span><span style="color:#98C379;">&#39;)</span></span>
<span class="line"><span style="color:#98C379;">FROM </span></span>
<span class="line"><span style="color:#98C379;">  information_schema.TABLES</span></span>
<span class="line"><span style="color:#98C379;">WHERE TABLE_SCHEMA = &#39;</span><span style="color:#ABB2BF;">数据库名</span><span style="color:#98C379;">&#39;;</span></span>
<span class="line"></span></code></pre></div></li><li><p>将执行结果复制，直接执行即可</p></li></ol>`,21);function _(s,u,g,S,b,k){const c=p("Badge"),r=d,i=p("ClientOnly");return o(),y("div",null,[t("h1",E,[l("个人常用 SQL 函数 "),e(c,{text:"持续更新",type:"warning"}),l(),m]),e(i,null,{default:A(()=>{var a,n;return[(((a=s.$frontmatter)==null?void 0:a.aside)??!0)&&(((n=s.$frontmatter)==null?void 0:n.showArticleMetadata)??!0)?(o(),D(r,{key:0,article:s.$frontmatter},null,8,["article"])):h("",!0)]}),_:1}),T])}const N=C(F,[["render",_]]);export{M as __pageData,N as default};
