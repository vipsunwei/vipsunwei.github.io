import{_ as r}from"./chunks/ArticleMetadata.dd4bf5dc.js";import{_ as p,c as i,g as c,w as d,b as n,f as m,a as C,i as y,o as l,e as h,j as u}from"./app.960cb299.js";const g="/assets/202210252119166.9d66bfe1.png",x=JSON.parse(`{"title":"解决 CentOS 8 执行 yum install 报 Error: Failed to download metadata for repo 'appstream': Cannot prepare internal mirrorlist: No URLs in mirrorlist 的问题","description":"","frontmatter":{"title":"解决 CentOS 8 执行 yum install 报 Error: Failed to download metadata for repo 'appstream': Cannot prepare internal mirrorlist: No URLs in mirrorlist 的问题","author":"查尔斯","date":"2022/10/25 21:20","categories":["Bug万象集"],"tags":["Linux","CentOS"]},"headers":[{"level":2,"title":"问题描述","slug":"问题描述","link":"#问题描述","children":[]},{"level":2,"title":"原因分析","slug":"原因分析","link":"#原因分析","children":[]},{"level":2,"title":"解决方案","slug":"解决方案","link":"#解决方案","children":[]},{"level":2,"title":"参考资料","slug":"参考资料","link":"#参考资料","children":[]}],"relativePath":"categories/issues/2022/10/25/解决CentOS8执行yum安装报错.md","lastUpdated":1677831742000}`),b={name:"categories/issues/2022/10/25/解决CentOS8执行yum安装报错.md"},A=n("h1",{id:"解决-centos-8-执行-yum-install-报-error-failed-to-download-metadata-for-repo-appstream-cannot-prepare-internal-mirrorlist-no-urls-in-mirrorlist-的问题",tabindex:"-1"},[m("解决 CentOS 8 执行 yum install 报 Error: Failed to download metadata for repo 'appstream': Cannot prepare internal mirrorlist: No URLs in mirrorlist 的问题 "),n("a",{class:"header-anchor",href:"#解决-centos-8-执行-yum-install-报-error-failed-to-download-metadata-for-repo-appstream-cannot-prepare-internal-mirrorlist-no-urls-in-mirrorlist-的问题","aria-hidden":"true"},"#")],-1),_=C(`<h2 id="问题描述" tabindex="-1">问题描述 <a class="header-anchor" href="#问题描述" aria-hidden="true">#</a></h2><p><strong>C：</strong> 今天，笔者在一台刚重装了 CentOS 8.2 操作系统的云服务器上正打算安装一下 Docker，结果开局安装依赖的环节就报错了。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">CentOS Linux 8 - AppStream</span></span>
<span class="line"><span style="color:#A6ACCD;">Error: Failed to download metadata for repo &#39;appstream&#39;: Cannot prepare internal mirrorlist: No URLs in mirrorlist</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#abb2bf;">CentOS Linux 8 - AppStream</span></span>
<span class="line"><span style="color:#abb2bf;">Error: Failed to download metadata for repo &#39;appstream&#39;: Cannot prepare internal mirrorlist: No URLs in mirrorlist</span></span>
<span class="line"><span style="color:#abb2bf;"></span></span></code></pre></div><p><img src="`+g+`" alt="202210252119166"></p><h2 id="原因分析" tabindex="-1">原因分析 <a class="header-anchor" href="#原因分析" aria-hidden="true">#</a></h2><p>首先排除掉是安装 Docker 引起的错误，因为笔者起初还尝试了下把三个依赖分开安装，想看看是不是由于某个依赖安装引起的，最终发现无论执行 yum 安装哪一个包都会报这个错。</p><p>而从报错信息的字面意思来看，应该是和 yum 的镜像源有关。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">错误：从仓库 ‘appstream’ 下载元数据失败：无法准备内部镜像列表：镜像列表中没有 url</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#abb2bf;">错误：从仓库 ‘appstream’ 下载元数据失败：无法准备内部镜像列表：镜像列表中没有 url</span></span>
<span class="line"><span style="color:#abb2bf;"></span></span></code></pre></div><p>这可就触碰到笔者的盲区部分了，最不擅长的就是这类 Linux 系统的初始配置，所以笔者搜索了一下，发现了一个较为靠谱的答案。</p><blockquote><p>2020 年 12 月 8 号，CentOS 官方宣布了停止维护 CentOS Linux 的计划，并推出了 CentOS Stream 项目，CentOS Linux 8 作为 RHEL 8 的复刻版本，生命周期缩短，于 2021 年 12 月 31 日停止更新并停止维护（EOL），更多的信息可以查看 CentOS 官方公告。[1]</p></blockquote><h2 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-hidden="true">#</a></h2><p>解决起来也较为容易，那就是如果需要更新 CentOS，需要将镜像从 <a href="http://mirror.centos.org" target="_blank" rel="noreferrer">mirror.centos.org</a> 更改为 <a href="http://vault.centos.org" target="_blank" rel="noreferrer">vault.centos.org</a>。</p><ol><li><p>进入 yum 的 repos 目录</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/yum.repos.d/</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/etc/yum.repos.d/</span></span>
<span class="line"></span></code></pre></div></li><li><p>替换镜像</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">sed</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s/mirrorlist/#mirrorlist/g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/yum.repos.d/CentOS-</span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#FFCB6B;">sed</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/yum.repos.d/CentOS-</span><span style="color:#A6ACCD;">*</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">sed </span><span style="color:#D19A66;">-i</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;s/mirrorlist/#mirrorlist/g&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/etc/yum.repos.d/CentOS-</span><span style="color:#E5C07B;">*</span></span>
<span class="line"><span style="color:#ABB2BF;">sed </span><span style="color:#D19A66;">-i</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/etc/yum.repos.d/CentOS-</span><span style="color:#E5C07B;">*</span></span>
<span class="line"></span></code></pre></div></li><li><p>生成缓存</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">makecache</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">yum </span><span style="color:#98C379;">makecache</span></span>
<span class="line"></span></code></pre></div></li><li><p>更新</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">update</span></span>
<span class="line"></span></code></pre><pre class="shiki one-dark-pro vp-code-light" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">yum </span><span style="color:#D19A66;">-y</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">update</span></span>
<span class="line"></span></code></pre></div></li></ol><p>等待更新完之后，再执行 yum 安装就正常了。</p><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-hidden="true">#</a></h2><ol><li>【已解决】Error: Failed to download metadata for repo ‘appstream‘: Cannot prepare internal mirrorlist：<a href="https://blog.csdn.net/weixin_43252521/article/details/124409151" target="_blank" rel="noreferrer">https://blog.csdn.net/weixin_43252521/article/details/124409151</a></li><li>CentOS 8 EOL如何切换源？：<a href="https://help.aliyun.com/document_detail/405635.html" target="_blank" rel="noreferrer">https://help.aliyun.com/document_detail/405635.html</a></li><li>CentOS Project shifts focus to CentOS Stream：<a href="https://blog.centos.org/2020/12/future-is-centos-stream/" target="_blank" rel="noreferrer">https://blog.centos.org/2020/12/future-is-centos-stream/</a></li></ol>`,16);function f(s,B,k,D,v,F){const t=r,o=y("ClientOnly");return l(),i("div",null,[A,c(o,null,{default:d(()=>{var a,e;return[(((a=s.$frontmatter)==null?void 0:a.aside)??!0)&&(((e=s.$frontmatter)==null?void 0:e.showArticleMetadata)??!0)?(l(),h(t,{key:0,article:s.$frontmatter},null,8,["article"])):u("",!0)]}),_:1}),_])}const E=p(b,[["render",f]]);export{x as __pageData,E as default};
